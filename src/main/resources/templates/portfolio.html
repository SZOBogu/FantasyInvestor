<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Portfolio</title>
</head>
<body onload="createPortfolioTable()">
    <div class="topnav">
        <a  href="/">Home</a>
        <a href="/portfolio">Portfolio</a>
        <a href="/stocks">Stocks</a>
        <a href="/leaderboard">Leaderboard</a>
        <a href="/logout">Logout</a>
    </div>

<h2 id="userIdh1"></h2>
<h2 id="usernameh2"></h2>
<div id="portfolioTableID">

</div>
</body>

<script>
    window.onload = function() {
        createPortfolioTable();
    };

    function createPortfolioTable(){
        var tableDiv = document.getElementById("portfolioTableID");
        var table = document.createElement("table");
        table.style.width = "100%";
        table.setAttribute("border", "1");
        var tbdy = document.createElement("tbody");

        var xhr = new XMLHttpRequest();
        var url = "http://localhost:8080/getPortfolio";
        xhr.open("GET", url, false);
        xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
        xhr.send();

        var json = JSON.parse(xhr.responseText);
        var assetData = json["assetData"];

        document.getElementById("userIdh1").innerHTML = "User id: " + json["id"];
        document.getElementById("usernameh2").innerHTML = "Username: " + json["username"];

        for (let i = 0; i < json["assetData"].length; i++) {
            row = document.createElement("tr");
            cellId = document.createElement("td");
            cellName = document.createElement("td");
            cellCurrentPrice = document.createElement("td");
            cellBuyingPrice = document.createElement("td");
            cellQuantity = document.createElement("td");
            cellTotal = document.createElement("td");

            textId = document.createTextNode(assetData[i].id);
            textName = document.createTextNode(assetData[i].name);
            textBuyingPrice = document.createTextNode(assetData[i].buyingPrice);
            textCurrentPrice = document.createTextNode(assetData[i].currentPrice);
            textQuantity = document.createTextNode(assetData[i].quantity);
            textTotal = document.createTextNode((assetData[i].currentPrice * json["assetData"][i].quantity).toString());

            cellId.appendChild(textId);
            cellName.appendChild(textName);
            cellCurrentPrice.appendChild(textBuyingPrice);
            cellBuyingPrice.appendChild(textCurrentPrice);

            row.appendChild(cellId);
            row.appendChild(cellName);
            row.appendChild(cellCurrentPrice);
            row.appendChild(cellBuyingPrice);

            table.appendChild(row);
        }
        tableDiv.appendChild(table);
    }

</script>

</html>